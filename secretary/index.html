<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Secretary | EveConnect</title>
  <link rel="shortcut icon" href="../img/logo.png" type="image/x-icon">
  <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" rel="stylesheet" />
  <link rel="shortcut icon" href="/img/logo.png" type="image/x-icon">
  <link rel="stylesheet" href="../css/department.css">
  <link rel="stylesheet" href="../css/task.css">
  <link rel="stylesheet" href="../css/header.css">
  <link rel="stylesheet" href="../css/desktop.css">
  <script src="/js/header.js" defer></script>
  <script src="sec.js" defer></script>
  <script src="index.js" defer></script>

  <style>
    /* Shared style for the bottom spreadsheet iframe */
    #dataSheetFrame {
        display: none; /* Hidden by default */
        width: 100%;
        height: 800px; 
        border: none;
        margin-top: 20px;
        background-color: white;
    }
  </style>

</head>
<body>
  <div id="header"></div>
  <a href="https://t.me/+xq3axo98cto2NjNl" target="_blank" class="telegram-float">
  <img src="https://cdn-icons-png.flaticon.com/512/2111/2111646.png" alt="Telegram" />
</a>
 
  <div class="main_container">
    <div class="content resizable">
      <div class="title">
        <h1>ğŸ’» Secretary</h1>
        <p>All tools and files for Secretary.</p>
      </div>

      <div class="sub_content">
    
        <div class="card"><a href="#" onclick="showAttendance(); return false;">Attendance</a></div>

        <div class="card"><a href="#" onclick="showOffForm(); return false;">Off/Absent Form</a></div>

        <div class="card"><a href="#" onclick="showCashAdvance(); return false;">Cash Advance/Loan</a></div>

        <div class="card"><a href="#" onclick="changeFrame('jo'); hideSheet(); return false;">Job Order Form</a></div>

        <div class="card"><a href="#" onclick="showStandardPage('feedback'); return false;">Feedback/Report</a></div>
      </div>

      <iframe id="mainFrame" src=""></iframe>

      <iframe id="dataSheetFrame" src=""></iframe>

      <div class="task-main-container">
        <div class="todo-form-container">
          <h1>ğŸ“ Task Manager</h1>
          <form id="todo-form">
            <label>Task Name</label>
            <input type="text" id="taskName" required>

            <label>Priority</label>
            <select id="priority">
              <option>High</option>
              <option>Medium</option>
              <option>Low</option>
            </select>

            <label>Assigned By</label>
            <input type="text" id="assignedBy" required>

            <label>Assigned To</label>
            <select id="assignTo" required>
              <option value="Secretary">Secretary</option>
              <option value="Marketing">Marketing</option>
              <option value="Property-Representative">Property Representative</option>
              <option value="Accounting">Accounting</option>
              <option value="IT">IT</option>
              <option value="Maintenance">Maintenance</option>
            </select>

            <label>Due Date</label>
            <input type="date" id="dueDate" required>

            <label>Details</label>
            <textarea id="notes" rows="3" style="
              width:100%;
              padding:8px;
              border:1px solid #ccc;
              border-radius:5px;
              resize:none;
              overflow:hidden;
              min-height:100px;
              max-height:300px;
              font-family:inherit;
              font-size:14px;
              line-height:1.4;
              box-sizing:border-box;"></textarea>

            <button type="submit">Save Task</button>
          </form>
          <p id="response" class="response"></p>
        </div>

        <div class="task-list-container">
          <h1>ğŸ“‹ Task List</h1>
          <div id="taskList" class="task-list"></div>
        </div>
      </div>
    </div>

    <div class="content resizable">
      <iframe 
        src="https://calendar.google.com/calendar/embed?src=08e9452d83d5dc0a473f7f8d8c9a20162bed560be6f2573bb858d42c052522e5%40group.calendar.google.com&ctz=Asia%2FManila" 
        frameborder="0" scrolling="no">
      </iframe>
    </div>

    <footer>
      <p>Â© 2025 Eve's Residences. All rights reserved.</p> 
      <p>Developed by Eve's Residences IT Department.</p> 
    </footer>
  </div>

  <script>
    // --- SPREADSHEET DISPLAY LOGIC ---
    
    function showAttendance() {
      changeFrame('attendance');
      const sheetFrame = document.getElementById('dataSheetFrame');
      sheetFrame.src = "https://docs.google.com/spreadsheets/d/1k-ryTpaGSjgv7Hl5v0phOpAkSXacHDyyr9bafTe4JbY/edit?widget=true&headers=false";
      sheetFrame.style.display = "block";
    }

    function showOffForm() {
      changeFrame('off');
      const sheetFrame = document.getElementById('dataSheetFrame');
      sheetFrame.src = "https://docs.google.com/spreadsheets/d/1inxxznuvGWAiHpjAtZA7j8L7gSETlPIs5SyZFUKO1ic/edit?widget=true&headers=false";
      sheetFrame.style.display = "block";
    }

    function showCashAdvance() {
      changeFrame('ca');
      const sheetFrame = document.getElementById('dataSheetFrame');
      // Added the Cash Advance spreadsheet link here
      sheetFrame.src = "https://docs.google.com/spreadsheets/d/1l3G6SZyPcqpKSFyIDdZRO5Jmg2pgDG0SZwwshe7_hMM/edit?widget=true&headers=false";
      sheetFrame.style.display = "block";
    }

    function hideSheet() {
      const sheetFrame = document.getElementById('dataSheetFrame');
      sheetFrame.style.display = "none";
    }

    // ---------------------------------------------------

    // Load shared header
  fetch("../header/header.html")
  .then(res => res.text())
  .then(data => {
    document.getElementById("header").innerHTML = data;

    const department = localStorage.getItem("department");
    const name = localStorage.getItem("name");

    if (!department || !name) {
      window.location.href = "../index.html";
      return;
    }

    const deptName = document.getElementById("dept-name");
    if (deptName) {
      const deptFormatted = department.toUpperCase() + " Department";
      deptName.textContent = `${deptFormatted} | ${name}`;
    }

    const menuToggle = document.querySelector(".menu-toggle");
    const subContent = document.querySelector(".sub_content");
    if (menuToggle && subContent) {
      menuToggle.addEventListener("click", () => {
        subContent.classList.toggle("active");
      });
    }
  })
  .catch(err => console.error("Error loading header:", err));
  </script>
</body>
</html>

